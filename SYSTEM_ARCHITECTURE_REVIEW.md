# ğŸ“Š Order Management System - Complete Architecture Review

## ğŸ—ï¸ System Overview

This is a comprehensive **Order Management & Inventory System** built with:

- **Backend**: NestJS (Node.js) with TypeORM
- **Frontend**: Angular 18+ (Standalone Components)
- **Database**: MySQL
- **Authentication**: JWT-based

---

## ğŸ‘¥ User Roles

| Role          | Description          | Permissions                               |
| ------------- | -------------------- | ----------------------------------------- |
| `super_admin` | System administrator | Full access to all modules                |
| `manager`     | Regional manager     | Manages assigned distributors             |
| `distributor` | Business partner     | Manages own inventory, billing, customers |

---

## ğŸ“¦ Backend Modules Structure

```
order-management/src/
â”œâ”€â”€ auth/                    # Authentication (Login, JWT)
â”œâ”€â”€ users/                   # User & Distributor management
â”œâ”€â”€ items/                   # Item Master (Products)
â”œâ”€â”€ categories/              # Product Categories
â”œâ”€â”€ inventory/               # Distributor Inventory + Batch/Serial
â”œâ”€â”€ batch-tracking/          # Batch Traceability
â”œâ”€â”€ orders/                  # Orders, Purchase Orders, GRN
â”œâ”€â”€ billing/                 # Sales Invoices
â”œâ”€â”€ customers/               # Customer Management
â”œâ”€â”€ returns/                 # Purchase & Sales Returns
â”œâ”€â”€ ledger/                  # Distributor Financial Ledger
â”œâ”€â”€ payment-requests/        # Payment Links (Razorpay)
â”œâ”€â”€ distributor-payment-entries/  # Payment Records
â”œâ”€â”€ reports/                 # Analytics & Reports
â”œâ”€â”€ internal-users/          # Internal Staff Management
â”œâ”€â”€ pincodes/                # Pincode Lookup Service
â””â”€â”€ whatsapp-webhook/        # WhatsApp Integration
```

---

## ğŸ—„ï¸ Database Schema - Entity Relationship

### Core Entities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER MANAGEMENT                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   user_master    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚   distributor        â”‚                      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  1:1    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
â”‚  â”‚ id               â”‚         â”‚ id                   â”‚                      â”‚
â”‚  â”‚ firstName        â”‚         â”‚ userId               â”‚                      â”‚
â”‚  â”‚ lastName         â”‚         â”‚ businessName         â”‚                      â”‚
â”‚  â”‚ email            â”‚         â”‚ gstin                â”‚                      â”‚
â”‚  â”‚ mobileNo         â”‚         â”‚ creditLimit          â”‚                      â”‚
â”‚  â”‚ password         â”‚         â”‚ currentBalance       â”‚                      â”‚
â”‚  â”‚ role             â”‚         â”‚ address, city, state â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚           â”‚                                                                  â”‚
â”‚           â”‚ M:N (manager_distributor)                                        â”‚
â”‚           â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚  â”‚ internal_users           â”‚                                               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                               â”‚
â”‚  â”‚ id, userId, department   â”‚                                               â”‚
â”‚  â”‚ designation, permissions â”‚                                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Product & Category Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PRODUCT MANAGEMENT                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   categories     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚   item_master        â”‚                      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  1:N    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
â”‚  â”‚ id               â”‚         â”‚ id                   â”‚                      â”‚
â”‚  â”‚ name             â”‚         â”‚ name                 â”‚                      â”‚
â”‚  â”‚ description      â”‚         â”‚ unit                 â”‚                      â”‚
â”‚  â”‚ parentCategoryId â”‚         â”‚ rate                 â”‚                      â”‚
â”‚  â”‚ isActive         â”‚         â”‚ qty                  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ gstRate              â”‚                      â”‚
â”‚                               â”‚ hsn, sac             â”‚                      â”‚
â”‚                               â”‚ sku                  â”‚                      â”‚
â”‚                               â”‚ categoryId           â”‚                      â”‚
â”‚                               â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
â”‚                               â”‚ hasBatchTracking  âœ“  â”‚ â—„â”€â”€ Tracking Flags   â”‚
â”‚                               â”‚ hasSerialTracking âœ“  â”‚                      â”‚
â”‚                               â”‚ hasExpiryDate     âœ“  â”‚                      â”‚
â”‚                               â”‚ hasBoxPackaging   âœ“  â”‚                      â”‚
â”‚                               â”‚ boxRate, unitsPerBox â”‚                      â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”¥ INVENTORY & BATCH/SERIAL TRACKING (Core Feature)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INVENTORY & BATCH/SERIAL TRACKING                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚  distributor_inventory     â”‚ â—„â”€â”€ Main Inventory Table                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ distributorId (FK)         â”‚â”€â”€â”€â”€â”€â”€â–º user_master                          â”‚
â”‚  â”‚ itemId (FK)                â”‚â”€â”€â”€â”€â”€â”€â–º item_master                          â”‚
â”‚  â”‚ quantity                   â”‚ â—„â”€â”€ Total available quantity                â”‚
â”‚  â”‚ reorderLevel               â”‚                                             â”‚
â”‚  â”‚ status (in_stock/low/out)  â”‚                                             â”‚
â”‚  â”‚ batchNumber (legacy)       â”‚                                             â”‚
â”‚  â”‚ serialNumber (legacy)      â”‚                                             â”‚
â”‚  â”‚ expiryDate (legacy)        â”‚                                             â”‚
â”‚  â”‚ notes                      â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”‚ 1:N                                                           â”‚
â”‚              â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     batch_details          â”‚    â”‚     serial_details         â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ id                         â”‚    â”‚ id                         â”‚           â”‚
â”‚  â”‚ inventoryId (FK)           â”‚    â”‚ inventoryId (FK)           â”‚           â”‚
â”‚  â”‚ batchNumber                â”‚    â”‚ serialNumber               â”‚           â”‚
â”‚  â”‚ quantity                   â”‚    â”‚ quantity (default: 1)      â”‚           â”‚
â”‚  â”‚ expiryDate                 â”‚    â”‚ expiryDate                 â”‚           â”‚
â”‚  â”‚ createdAt                  â”‚    â”‚ createdAt                  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚     item_batch             â”‚ â—„â”€â”€ Alternative Batch Tracking              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ companyId                  â”‚                                             â”‚
â”‚  â”‚ itemId (FK)                â”‚                                             â”‚
â”‚  â”‚ distributorId              â”‚                                             â”‚
â”‚  â”‚ warehouseId                â”‚                                             â”‚
â”‚  â”‚ batchNumber                â”‚                                             â”‚
â”‚  â”‚ manufactureDate            â”‚                                             â”‚
â”‚  â”‚ expiryDate                 â”‚                                             â”‚
â”‚  â”‚ receivedQty                â”‚                                             â”‚
â”‚  â”‚ reservedQty                â”‚                                             â”‚
â”‚  â”‚ issuedQty                  â”‚                                             â”‚
â”‚  â”‚ availableQty               â”‚                                             â”‚
â”‚  â”‚ isBlocked, isExpired       â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Purchase Order & GRN Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PURCHASE ORDER & GRN FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚  purchase_order_master     â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ poNo (unique)              â”‚                                             â”‚
â”‚  â”‚ distributorId (FK)         â”‚                                             â”‚
â”‚  â”‚ totalAmount                â”‚                                             â”‚
â”‚  â”‚ status (PENDING/DELIVERED) â”‚                                             â”‚
â”‚  â”‚ approvalStatus             â”‚                                             â”‚
â”‚  â”‚ approvedBy, approvedAt     â”‚                                             â”‚
â”‚  â”‚ rejectedBy, rejectionReasonâ”‚                                             â”‚
â”‚  â”‚ grnStatus                  â”‚                                             â”‚
â”‚  â”‚ grnId                      â”‚                                             â”‚
â”‚  â”‚ invoiceUrl                 â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”‚ 1:N                                                           â”‚
â”‚              â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚  purchase_order_items      â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ purchaseOrderId (FK)       â”‚                                             â”‚
â”‚  â”‚ itemId (FK)                â”‚                                             â”‚
â”‚  â”‚ quantity                   â”‚                                             â”‚
â”‚  â”‚ unitPrice                  â”‚                                             â”‚
â”‚  â”‚ batchNumber, serialNumber  â”‚                                             â”‚
â”‚  â”‚ expiryDate                 â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                         GRN (Goods Receipt Note)                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚      grn_master            â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ grnNo (unique)             â”‚                                             â”‚
â”‚  â”‚ purchaseOrderId (FK)       â”‚                                             â”‚
â”‚  â”‚ distributorId (FK)         â”‚                                             â”‚
â”‚  â”‚ status (DRAFT/APPROVED)    â”‚                                             â”‚
â”‚  â”‚ totalAmount                â”‚                                             â”‚
â”‚  â”‚ approvedBy, approvedAt     â”‚                                             â”‚
â”‚  â”‚ remarks                    â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”‚ 1:N                                                           â”‚
â”‚              â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚      grn_items             â”‚â”€â”€â”€â–ºâ”‚   grn_batch_details        â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 1:Nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ id                         â”‚    â”‚ id                         â”‚           â”‚
â”‚  â”‚ grnId (FK)                 â”‚    â”‚ grnItemId (FK)             â”‚           â”‚
â”‚  â”‚ poItemId (FK)              â”‚    â”‚ batchNumber                â”‚           â”‚
â”‚  â”‚ itemId (FK)                â”‚    â”‚ quantity                   â”‚           â”‚
â”‚  â”‚ receivedQuantity           â”‚    â”‚ serialNumber               â”‚           â”‚
â”‚  â”‚ originalQuantity           â”‚    â”‚ expiryDate                 â”‚           â”‚
â”‚  â”‚ unitPrice                  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚ pendingQuantity            â”‚                                             â”‚
â”‚  â”‚ batchNumber, serialNumber  â”‚                                             â”‚
â”‚  â”‚ expiryDate                 â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Billing & Sales Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BILLING & SALES FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚       customers            â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ firstname, lastname        â”‚                                             â”‚
â”‚  â”‚ mobileNo, emailId          â”‚                                             â”‚
â”‚  â”‚ gstin                      â”‚                                             â”‚
â”‚  â”‚ addressLine1, addressLine2 â”‚                                             â”‚
â”‚  â”‚ city, state, pincode       â”‚                                             â”‚
â”‚  â”‚ distributorId (FK)         â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”‚ 1:N                                                           â”‚
â”‚              â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚        billings            â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ id                         â”‚                                             â”‚
â”‚  â”‚ billNo (unique)            â”‚                                             â”‚
â”‚  â”‚ billDate                   â”‚                                             â”‚
â”‚  â”‚ customerId (FK)            â”‚                                             â”‚
â”‚  â”‚ distributorId (FK)         â”‚                                             â”‚
â”‚  â”‚ subtotal                   â”‚                                             â”‚
â”‚  â”‚ overallDiscount            â”‚                                             â”‚
â”‚  â”‚ overallDiscountType        â”‚                                             â”‚
â”‚  â”‚ totalAfterDiscount         â”‚                                             â”‚
â”‚  â”‚ cgstTotal, sgstTotal       â”‚                                             â”‚
â”‚  â”‚ igstTotal                  â”‚                                             â”‚
â”‚  â”‚ grandTotal                 â”‚                                             â”‚
â”‚  â”‚ roundOff                   â”‚                                             â”‚
â”‚  â”‚ finalAmount                â”‚                                             â”‚
â”‚  â”‚ status, approvalStatus     â”‚                                             â”‚
â”‚  â”‚ paymentStatus              â”‚                                             â”‚
â”‚  â”‚ paymentType (cash/online)  â”‚                                             â”‚
â”‚  â”‚ amountPaid, amountDue      â”‚                                             â”‚
â”‚  â”‚ invoiceNo, invoiceDate     â”‚                                             â”‚
â”‚  â”‚ cropName, cropDiseases     â”‚ â—„â”€â”€ Agriculture-specific fields             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚              â”‚                                                               â”‚
â”‚              â”‚ 1:N                                                           â”‚
â”‚              â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     billing_items          â”‚    â”‚  billing_batch_details     â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ id                         â”‚    â”‚ id                         â”‚           â”‚
â”‚  â”‚ billingId (FK)             â”‚    â”‚ billingId (FK)             â”‚           â”‚
â”‚  â”‚ itemId (FK)                â”‚    â”‚ itemId                     â”‚           â”‚
â”‚  â”‚ itemName                   â”‚    â”‚ batchDetailId (FK)         â”‚           â”‚
â”‚  â”‚ unit                       â”‚    â”‚ serialDetailId (FK)        â”‚           â”‚
â”‚  â”‚ quantity                   â”‚    â”‚ batchNumber                â”‚           â”‚
â”‚  â”‚ rate                       â”‚    â”‚ serialNumber               â”‚           â”‚
â”‚  â”‚ discount, discountType     â”‚    â”‚ expiryDate                 â”‚           â”‚
â”‚  â”‚ taxableAmount              â”‚    â”‚ quantity                   â”‚           â”‚
â”‚  â”‚ cgst, sgst, igst           â”‚    â”‚ rate                       â”‚           â”‚
â”‚  â”‚ totalAmount                â”‚    â”‚ deliveredAt                â”‚           â”‚
â”‚  â”‚ batchNumber, serialNumber  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚ expiryDate                 â”‚                                             â”‚
â”‚  â”‚ orderedByBox               â”‚                                             â”‚
â”‚  â”‚ boxCount, boxRate          â”‚                                             â”‚
â”‚  â”‚ unitsPerBox                â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Returns & Financial Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RETURNS & FINANCIAL MANAGEMENT                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚    purchase_returns        â”‚    â”‚     sales_returns          â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ id                         â”‚    â”‚ id                         â”‚           â”‚
â”‚  â”‚ returnNo                   â”‚    â”‚ returnNo                   â”‚           â”‚
â”‚  â”‚ returnDate                 â”‚    â”‚ returnDate                 â”‚           â”‚
â”‚  â”‚ distributorId (FK)         â”‚    â”‚ distributorId (FK)         â”‚           â”‚
â”‚  â”‚ itemId (FK)                â”‚    â”‚ itemId (FK)                â”‚           â”‚
â”‚  â”‚ quantity                   â”‚    â”‚ quantity                   â”‚           â”‚
â”‚  â”‚ rate                       â”‚    â”‚ rate                       â”‚           â”‚
â”‚  â”‚ totalAmount                â”‚    â”‚ totalAmount                â”‚           â”‚
â”‚  â”‚ reason                     â”‚    â”‚ reason                     â”‚           â”‚
â”‚  â”‚ status (pending/approved)  â”‚    â”‚ status                     â”‚           â”‚
â”‚  â”‚ rejectionReason            â”‚    â”‚ batchNumber, serialNumber  â”‚           â”‚
â”‚  â”‚ adminComments              â”‚    â”‚ expiryDate                 â”‚           â”‚
â”‚  â”‚ batchNumber, serialNumber  â”‚    â”‚ batchDetailId              â”‚           â”‚
â”‚  â”‚ expiryDate                 â”‚    â”‚ serialDetailId             â”‚           â”‚
â”‚  â”‚ batchDetailId              â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚ serialDetailId             â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                           FINANCIAL LEDGER                                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   distributor_ledger       â”‚    â”‚ distributor_payment_entry  â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ id                         â”‚    â”‚ id                         â”‚           â”‚
â”‚  â”‚ distributorId (FK)         â”‚    â”‚ distributorId (FK)         â”‚           â”‚
â”‚  â”‚ transactionType            â”‚    â”‚ amount                     â”‚           â”‚
â”‚  â”‚   - PURCHASE               â”‚    â”‚ paymentDate                â”‚           â”‚
â”‚  â”‚   - PAYMENT                â”‚    â”‚ paymentMode                â”‚           â”‚
â”‚  â”‚   - CREDIT_ADJUSTMENT      â”‚    â”‚ referenceNo                â”‚           â”‚
â”‚  â”‚   - REFUND                 â”‚    â”‚ remarks                    â”‚           â”‚
â”‚  â”‚   - OPENING_BALANCE        â”‚    â”‚ status                     â”‚           â”‚
â”‚  â”‚ amount                     â”‚    â”‚ approvedBy                 â”‚           â”‚
â”‚  â”‚ description                â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚ referenceNo                â”‚                                             â”‚
â”‚  â”‚ referenceType              â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ referenceId                â”‚    â”‚    payment_requests        â”‚           â”‚
â”‚  â”‚ runningBalance             â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ id                         â”‚           â”‚
â”‚                                    â”‚ distributorId (FK)         â”‚           â”‚
â”‚                                    â”‚ billingId (FK)             â”‚           â”‚
â”‚                                    â”‚ amount                     â”‚           â”‚
â”‚                                    â”‚ status                     â”‚           â”‚
â”‚                                    â”‚ razorpayLinkId             â”‚           â”‚
â”‚                                    â”‚ razorpayPaymentId          â”‚           â”‚
â”‚                                    â”‚ paidAt                     â”‚           â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¥ï¸ Frontend Components Structure

```
order-management-frontend/src/app/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ admin-dashboard/           # Super Admin Dashboard
â”‚   â”œâ”€â”€ manager-dashboard/         # Manager Dashboard
â”‚   â”œâ”€â”€ distributor-dashboard/     # Distributor Dashboard
â”‚   â”‚
â”‚   â”œâ”€â”€ login/                     # Authentication
â”‚   â”‚
â”‚   â”œâ”€â”€ users/                     # User Management (Admin)
â”‚   â”‚   â””â”€â”€ user-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ internal-users/            # Internal Staff Management
â”‚   â”‚   â””â”€â”€ internal-user-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ categories/                # Category Management
â”‚   â”‚   â””â”€â”€ category-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ items/                     # Item Master
â”‚   â”‚   â””â”€â”€ item-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ inventory/                 # Inventory Management
â”‚   â”‚   â””â”€â”€ inventory-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ customers/                 # Customer Management
â”‚   â”‚   â””â”€â”€ customer-master.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ purchase-orders/           # Purchase Order Module
â”‚   â”‚   â”œâ”€â”€ purchase-order-create.component.ts
â”‚   â”‚   â”œâ”€â”€ purchase-order-list.component.ts
â”‚   â”‚   â”œâ”€â”€ in-ward.component.ts
â”‚   â”‚   â””â”€â”€ batch-entry.modal.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ grn/                       # Goods Receipt Note
â”‚   â”‚   â”œâ”€â”€ grn-create.component.ts
â”‚   â”‚   â””â”€â”€ grn-detail.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ billing/                   # Sales Billing
â”‚   â”‚   â”œâ”€â”€ billing-master.component.ts
â”‚   â”‚   â”œâ”€â”€ billing-history.component.ts
â”‚   â”‚   â”œâ”€â”€ batch-selector.component.ts
â”‚   â”‚   â””â”€â”€ batch-serial-input.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ billings/                  # Billing List (Admin View)
â”‚   â”‚   â””â”€â”€ billing-list.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ returns/                   # Returns Management
â”‚   â”‚   â”œâ”€â”€ purchase-return-create.component.ts
â”‚   â”‚   â”œâ”€â”€ purchase-return-list.component.ts
â”‚   â”‚   â”œâ”€â”€ sales-return-create.component.ts
â”‚   â”‚   â”œâ”€â”€ sales-return-list.component.ts
â”‚   â”‚   â”œâ”€â”€ distributor-po-returns.component.ts
â”‚   â”‚   â””â”€â”€ admin-po-returns-approval.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ distributor-returns/       # Distributor Returns View
â”‚   â”‚   â””â”€â”€ distributor-returns.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ payment-entries/           # Payment Records
â”‚   â”‚   â””â”€â”€ payment-entries.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ payment-requests/          # Payment Links
â”‚   â”‚   â”œâ”€â”€ payment-requests.component.ts
â”‚   â”‚   â””â”€â”€ payment-requests-admin.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ admin-payment-entries/     # Admin Payment Management
â”‚   â”‚   â”œâ”€â”€ admin-payment-entries-list.component.ts
â”‚   â”‚   â”œâ”€â”€ admin-payment-entries-form.component.ts
â”‚   â”‚   â””â”€â”€ admin-payment-entries-detail.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ distributor-ledger/        # Financial Ledger
â”‚   â”‚   â””â”€â”€ distributor-ledger.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ product-trace/             # Batch/Serial Traceability
â”‚   â”‚   â””â”€â”€ product-trace.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ reports/                   # Analytics & Reports
â”‚   â”‚   â””â”€â”€ reports.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ approvals/                 # Approval Workflows
â”‚   â”‚   â””â”€â”€ approvals.component.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ orders/                    # Legacy Orders
â”‚   â”‚   â””â”€â”€ order-master.component.ts
â”‚   â”‚
â”‚   â””â”€â”€ shared/                    # Shared Components
â”‚       â”œâ”€â”€ add-customer-form.component.ts
â”‚       â”œâ”€â”€ global-search.component.ts
â”‚       â””â”€â”€ ui/
â”‚
â”œâ”€â”€ services/                      # API Services
â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”œâ”€â”€ item.service.ts
â”‚   â”œâ”€â”€ category.service.ts
â”‚   â”œâ”€â”€ inventory.service.ts
â”‚   â”œâ”€â”€ customer.service.ts
â”‚   â”œâ”€â”€ purchase-order.service.ts
â”‚   â”œâ”€â”€ grn.service.ts
â”‚   â”œâ”€â”€ billing.service.ts
â”‚   â”œâ”€â”€ batch-serial.service.ts
â”‚   â”œâ”€â”€ returns.service.ts
â”‚   â”œâ”€â”€ ledger.service.ts
â”‚   â”œâ”€â”€ payment-request.service.ts
â”‚   â”œâ”€â”€ distributor-payment-entry.service.ts
â”‚   â”œâ”€â”€ reports.service.ts
â”‚   â”œâ”€â”€ internal-user.service.ts
â”‚   â”œâ”€â”€ manager.service.ts
â”‚   â”œâ”€â”€ order.service.ts
â”‚   â”œâ”€â”€ pincode.service.ts
â”‚   â”œâ”€â”€ global-search.service.ts
â”‚   â”œâ”€â”€ bulk-import.service.ts
â”‚   â””â”€â”€ excel.service.ts
â”‚
â”œâ”€â”€ interceptors/
â”‚   â””â”€â”€ auth.interceptor.ts        # JWT Token Interceptor
â”‚
â””â”€â”€ pipes/
    â””â”€â”€ inr-format.pipe.ts         # Indian Rupee Formatting
```

---

## ğŸ”„ Business Logic Flows

### 1. Purchase Order â†’ GRN â†’ Inventory Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PURCHASE ORDER TO INVENTORY FLOW                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. DISTRIBUTOR CREATES PO                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ Select items from item_master                                  â”‚     â”‚
â”‚     â”‚ â€¢ Specify quantities and prices                                  â”‚     â”‚
â”‚     â”‚ â€¢ PO status: PENDING                                             â”‚     â”‚
â”‚     â”‚ â€¢ Approval status: PENDING                                       â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  2. ADMIN/MANAGER APPROVES PO                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ Review PO details                                              â”‚     â”‚
â”‚     â”‚ â€¢ Check credit limit                                             â”‚     â”‚
â”‚     â”‚ â€¢ Approve or Reject with reason                                  â”‚     â”‚
â”‚     â”‚ â€¢ Approval status: APPROVED/REJECTED                             â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  3. ADMIN MARKS PO AS DELIVERED                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ Upload invoice document                                        â”‚     â”‚
â”‚     â”‚ â€¢ PO status: DELIVERED                                           â”‚     â”‚
â”‚     â”‚ â€¢ GRN status: PENDING                                            â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  4. DISTRIBUTOR CREATES GRN                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ Enter received quantities                                      â”‚     â”‚
â”‚     â”‚ â€¢ âœ… VALIDATION: If item.hasBatchTracking = true                 â”‚     â”‚
â”‚     â”‚      â†’ batchDetails[] required                                   â”‚     â”‚
â”‚     â”‚      â†’ Total batch qty must equal received qty                   â”‚     â”‚
â”‚     â”‚ â€¢ âœ… VALIDATION: If item.hasSerialTracking = true                â”‚     â”‚
â”‚     â”‚      â†’ serialDetails[] required                                  â”‚     â”‚
â”‚     â”‚      â†’ Total serial qty must equal received qty                  â”‚     â”‚
â”‚     â”‚      â†’ All serial numbers must be unique                         â”‚     â”‚
â”‚     â”‚ â€¢ GRN status: DRAFT                                              â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  5. DISTRIBUTOR APPROVES GRN                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ GRN status: APPROVED                                           â”‚     â”‚
â”‚     â”‚ â€¢ âœ… AUTO-UPDATE: distributor_inventory.quantity += received     â”‚     â”‚
â”‚     â”‚ â€¢ âœ… AUTO-CREATE: batch_details records                          â”‚     â”‚
â”‚     â”‚ â€¢ âœ… AUTO-CREATE: serial_details records                         â”‚     â”‚
â”‚     â”‚ â€¢ PO grnStatus: COMPLETED                                        â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Billing (Sales) â†’ Inventory Deduction Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BILLING TO INVENTORY DEDUCTION FLOW                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. DISTRIBUTOR CREATES BILLING                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ Select customer                                                â”‚     â”‚
â”‚     â”‚ â€¢ Add items from inventory                                       â”‚     â”‚
â”‚     â”‚ â€¢ âœ… VALIDATION: Check stock availability                        â”‚     â”‚
â”‚     â”‚ â€¢ âœ… VALIDATION: If item.hasBatchTracking = true                 â”‚     â”‚
â”‚     â”‚      â†’ batchNumber required                                      â”‚     â”‚
â”‚     â”‚      â†’ Check batch quantity available                            â”‚     â”‚
â”‚     â”‚      â†’ Check batch not expired                                   â”‚     â”‚
â”‚     â”‚ â€¢ âœ… VALIDATION: If item.hasSerialTracking = true                â”‚     â”‚
â”‚     â”‚      â†’ serialNumber required                                     â”‚     â”‚
â”‚     â”‚      â†’ Check serial exists in inventory                          â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  2. INVENTORY AUTO-DEDUCTION (On Billing Create)                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ âœ… distributor_inventory.quantity -= sold_qty                  â”‚     â”‚
â”‚     â”‚ â€¢ âœ… batch_details.quantity -= sold_qty (if batch tracked)       â”‚     â”‚
â”‚     â”‚ â€¢ âœ… DELETE serial_details record (if serial tracked)            â”‚     â”‚
â”‚     â”‚ â€¢ âœ… CREATE billing_batch_details for traceability               â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â–¼                                               â”‚
â”‚  3. PAYMENT HANDLING                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ â€¢ If paymentType = 'cash' â†’ Mark as paid                         â”‚     â”‚
â”‚     â”‚ â€¢ If paymentType = 'credit' â†’ Create payment_request             â”‚     â”‚
â”‚     â”‚ â€¢ If paymentType = 'online' â†’ Razorpay integration               â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Batch & Serial Tracking Summary

### Item Master Tracking Flags

| Flag                | Purpose                      | When Required                            |
| ------------------- | ---------------------------- | ---------------------------------------- |
| `hasBatchTracking`  | Track items by batch number  | Medicines, food products, chemicals      |
| `hasSerialTracking` | Track items by unique serial | Electronics, equipment, high-value items |
| `hasExpiryDate`     | Track expiry dates           | Perishable goods                         |
| `hasBoxPackaging`   | Support box-level ordering   | Bulk items sold in boxes                 |

### Batch/Serial Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BATCH/SERIAL DATA FLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  INWARD (GRN)                          OUTWARD (Billing)                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚                                                                              â”‚
â”‚  grn_batch_details                     billing_batch_details                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ batchNumber     â”‚                   â”‚ batchNumber     â”‚                   â”‚
â”‚  â”‚ quantity        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚ quantity        â”‚                   â”‚
â”‚  â”‚ serialNumber    â”‚   INVENTORY       â”‚ serialNumber    â”‚                   â”‚
â”‚  â”‚ expiryDate      â”‚                   â”‚ expiryDate      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚          â”‚                                      â”‚                            â”‚
â”‚          â–¼                                      â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚                    INVENTORY TABLES                              â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚        â”‚
â”‚  â”‚  â”‚  batch_details  â”‚    â”‚  serial_details â”‚                     â”‚        â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                     â”‚        â”‚
â”‚  â”‚  â”‚  batchNumber    â”‚    â”‚  serialNumber   â”‚                     â”‚        â”‚
â”‚  â”‚  â”‚  quantity (+/-) â”‚    â”‚  quantity       â”‚                     â”‚        â”‚
â”‚  â”‚  â”‚  expiryDate     â”‚    â”‚  expiryDate     â”‚                     â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚        â”‚
â”‚  â”‚                                                                  â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚
â”‚  â”‚  â”‚              distributor_inventory                       â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  quantity (total available)                              â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  status (in_stock / low_stock / out_of_stock)           â”‚    â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Traceability Features

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PRODUCT TRACEABILITY                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  SEARCH BY BATCH/SERIAL NUMBER:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Input: "BATCH001" or "SN12345"                                   â”‚        â”‚
â”‚  â”‚                                                                  â”‚        â”‚
â”‚  â”‚ Output:                                                          â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ Item Details (name, category, tracking flags)               â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ Current Location (distributor, warehouse)                   â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ Quantity Status (received, issued, available)               â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ Expiry Information (date, days remaining)                   â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ GRN History (when received, from which PO)                  â”‚        â”‚
â”‚  â”‚ â”œâ”€â”€ Sales History (which customers purchased)                   â”‚        â”‚
â”‚  â”‚ â””â”€â”€ Return History (if any returns)                             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                              â”‚
â”‚  EXPIRY ALERTS:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ â€¢ Expired batches (cannot be sold)                              â”‚        â”‚
â”‚  â”‚ â€¢ Expiring within 7 days (CRITICAL)                             â”‚        â”‚
â”‚  â”‚ â€¢ Expiring within 15 days (HIGH)                                â”‚        â”‚
â”‚  â”‚ â€¢ Expiring within 30 days (MEDIUM)                              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Complete Database Tables List

### Core Tables (24 Tables)

| #   | Table Name                  | Purpose                                 | Key Relations                        |
| --- | --------------------------- | --------------------------------------- | ------------------------------------ |
| 1   | `user_master`               | All users (admin, manager, distributor) | -                                    |
| 2   | `distributor`               | Distributor business details            | â†’ user_master                        |
| 3   | `manager_distributor`       | Manager-Distributor mapping (M:N)       | â†’ user_master                        |
| 4   | `internal_users`            | Internal staff                          | â†’ user_master                        |
| 5   | `internal_user_distributor` | Staff-Distributor mapping               | â†’ internal_users                     |
| 6   | `categories`                | Product categories (hierarchical)       | Self-referencing                     |
| 7   | `item_master`               | Products/Items                          | â†’ categories                         |
| 8   | `customers`                 | Customer records                        | â†’ user_master (distributor)          |
| 9   | `distributor_inventory`     | Inventory per distributor               | â†’ user_master, item_master           |
| 10  | `batch_details`             | Batch tracking records                  | â†’ distributor_inventory              |
| 11  | `serial_details`            | Serial tracking records                 | â†’ distributor_inventory              |
| 12  | `item_batch`                | Alternative batch tracking              | â†’ item_master                        |
| 13  | `purchase_order_master`     | Purchase orders                         | â†’ user_master                        |
| 14  | `purchase_order_items`      | PO line items                           | â†’ purchase_order_master, item_master |
| 15  | `grn_master`                | Goods Receipt Notes                     | â†’ purchase_order_master              |
| 16  | `grn_items`                 | GRN line items                          | â†’ grn_master, item_master            |
| 17  | `grn_batch_details`         | GRN batch/serial records                | â†’ grn_items                          |
| 18  | `billings`                  | Sales invoices                          | â†’ customers, user_master             |
| 19  | `billing_items`             | Invoice line items                      | â†’ billings, item_master              |
| 20  | `billing_batch_details`     | Sales batch/serial records              | â†’ billings                           |
| 21  | `purchase_returns`          | Purchase return requests                | â†’ user_master, item_master           |
| 22  | `sales_returns`             | Sales return requests                   | â†’ user_master, item_master           |
| 23  | `distributor_ledger`        | Financial transactions                  | â†’ user_master                        |
| 24  | `distributor_payment_entry` | Payment records                         | â†’ user_master                        |
| 25  | `payment_requests`          | Payment links (Razorpay)                | â†’ billings                           |

---

## ğŸ” API Endpoints Summary

### Authentication

| Method | Endpoint      | Description |
| ------ | ------------- | ----------- |
| POST   | `/auth/login` | User login  |

### Users & Distributors

| Method | Endpoint              | Description       |
| ------ | --------------------- | ----------------- |
| GET    | `/users`              | List all users    |
| POST   | `/users`              | Create user       |
| GET    | `/users/:id`          | Get user details  |
| PUT    | `/users/:id`          | Update user       |
| DELETE | `/users/:id`          | Delete user       |
| GET    | `/users/distributors` | List distributors |

### Items & Categories

| Method | Endpoint             | Description     |
| ------ | -------------------- | --------------- |
| GET    | `/items`             | List items      |
| POST   | `/items`             | Create item     |
| GET    | `/items/:id`         | Get item        |
| PUT    | `/items/:id`         | Update item     |
| DELETE | `/items/:id`         | Delete item     |
| PUT    | `/items/:id/disable` | Disable item    |
| GET    | `/categories`        | List categories |
| POST   | `/categories`        | Create category |

### Inventory

| Method | Endpoint                      | Description         |
| ------ | ----------------------------- | ------------------- |
| GET    | `/inventory`                  | List inventory      |
| POST   | `/inventory`                  | Create inventory    |
| PUT    | `/inventory/:id`              | Update inventory    |
| GET    | `/inventory/:id/batches`      | Get batch details   |
| POST   | `/inventory/:id/batches/bulk` | Bulk upload batches |
| GET    | `/inventory/:id/serials`      | Get serial details  |
| POST   | `/inventory/:id/serials/bulk` | Bulk upload serials |
| GET    | `/inventory/low-stock`        | Low stock items     |
| GET    | `/inventory/out-of-stock`     | Out of stock items  |

### Purchase Orders

| Method | Endpoint                       | Description    |
| ------ | ------------------------------ | -------------- |
| GET    | `/purchase-orders`             | List POs       |
| POST   | `/purchase-orders`             | Create PO      |
| GET    | `/purchase-orders/:id`         | Get PO         |
| PUT    | `/purchase-orders/:id/approve` | Approve PO     |
| PUT    | `/purchase-orders/:id/reject`  | Reject PO      |
| PUT    | `/purchase-orders/:id/deliver` | Mark delivered |

### GRN

| Method | Endpoint           | Description |
| ------ | ------------------ | ----------- |
| GET    | `/grn`             | List GRNs   |
| POST   | `/grn`             | Create GRN  |
| GET    | `/grn/:id`         | Get GRN     |
| PUT    | `/grn/:id/approve` | Approve GRN |

### Billing

| Method | Endpoint                       | Description            |
| ------ | ------------------------------ | ---------------------- |
| GET    | `/billing`                     | List billings          |
| POST   | `/billing`                     | Create billing         |
| GET    | `/billing/:id`                 | Get billing            |
| PUT    | `/billing/:id`                 | Update billing         |
| PUT    | `/billing/:id/approve`         | Approve billing        |
| GET    | `/billing/:id/pdf`             | Generate PDF           |
| GET    | `/billing/search/batch-serial` | Search by batch/serial |

### Returns

| Method | Endpoint                        | Description            |
| ------ | ------------------------------- | ---------------------- |
| GET    | `/returns/purchase`             | List purchase returns  |
| POST   | `/returns/purchase`             | Create purchase return |
| PUT    | `/returns/purchase/:id/approve` | Approve return         |
| GET    | `/returns/sales`                | List sales returns     |
| POST   | `/returns/sales`                | Create sales return    |

### Batch Tracking

| Method | Endpoint                          | Description         |
| ------ | --------------------------------- | ------------------- |
| GET    | `/batch-tracking/:batchNumber`    | Get batch details   |
| GET    | `/batch-tracking/distributor/:id` | Distributor batches |
| GET    | `/batch-tracking/expiring`        | Expiring batches    |

---

## âœ… Current Implementation Status

### Fully Implemented Features âœ…

| Module           | Feature                  | Status      |
| ---------------- | ------------------------ | ----------- |
| **Auth**         | JWT Login                | âœ… Complete |
| **Users**        | CRUD Operations          | âœ… Complete |
| **Users**        | Role-based Access        | âœ… Complete |
| **Items**        | CRUD with Tracking Flags | âœ… Complete |
| **Items**        | Boolean Field Transform  | âœ… Fixed    |
| **Categories**   | Hierarchical Categories  | âœ… Complete |
| **Inventory**    | Distributor Inventory    | âœ… Complete |
| **Inventory**    | Batch Details            | âœ… Complete |
| **Inventory**    | Serial Details           | âœ… Complete |
| **Inventory**    | Bulk Excel Import        | âœ… Complete |
| **PO**           | Create/List/View         | âœ… Complete |
| **PO**           | Approval Workflow        | âœ… Complete |
| **PO**           | Delivery Marking         | âœ… Complete |
| **GRN**          | Create with Validation   | âœ… Complete |
| **GRN**          | Batch/Serial Validation  | âœ… Complete |
| **GRN**          | Quantity Validation      | âœ… Complete |
| **GRN**          | Inventory Auto-Update    | âœ… Complete |
| **Billing**      | Create Invoice           | âœ… Complete |
| **Billing**      | Batch/Serial Validation  | âœ… Complete |
| **Billing**      | Inventory Deduction      | âœ… Complete |
| **Billing**      | GST Calculation          | âœ… Complete |
| **Billing**      | PDF Generation           | âœ… Complete |
| **Billing**      | Batch Search             | âœ… Fixed    |
| **Returns**      | Purchase Returns         | âœ… Complete |
| **Returns**      | Sales Returns            | âœ… Complete |
| **Ledger**       | Transaction History      | âœ… Complete |
| **Payments**     | Payment Entries          | âœ… Complete |
| **Payments**     | Razorpay Integration     | âœ… Complete |
| **Reports**      | Analytics Dashboard      | âœ… Complete |
| **Traceability** | Batch/Serial Search      | âœ… Complete |

### Recent Fixes Applied âœ…

| Issue                           | Fix                                 | Status   |
| ------------------------------- | ----------------------------------- | -------- |
| PO View Modal toFixed Error     | Added `formatCurrency()` helper     | âœ… Fixed |
| Item Update 404 Error           | Changed PATCH to PUT                | âœ… Fixed |
| Boolean Fields Not Updating     | Added `@Transform` decorators       | âœ… Fixed |
| Delete/Disable Confirmation     | Added confirmation dialogs          | âœ… Fixed |
| Billing Default Date            | Form initialization fixed           | âœ… Fixed |
| Billing Discount Not Reflecting | Added reactive signal               | âœ… Fixed |
| GST Rate Not Loading            | Added to SELECT query               | âœ… Fixed |
| Batch/Serial Billing Validation | Added frontend + backend validation | âœ… Fixed |
| Batch Search Not Working        | Fixed ngModel binding               | âœ… Fixed |
| Batch Selector Add Item         | Fixed form patchValue               | âœ… Fixed |
| GRN Batch/Serial Mandatory      | Added validation in service         | âœ… Fixed |
| GRN Quantity Validation         | Added total qty check               | âœ… Fixed |
| PO Approve from View Modal      | Added helper methods                | âœ… Fixed |

---

## ğŸ Summary

This is a comprehensive **Order Management & Inventory System** with:

1. **Multi-role Authentication** (Super Admin, Manager, Distributor)
2. **Complete Product Management** with categories and tracking flags
3. **Full Inventory Management** with batch and serial tracking
4. **Purchase Order Workflow** with approval process
5. **GRN Processing** with validation and auto-inventory update
6. **Sales Billing** with GST, discounts, and inventory deduction
7. **Returns Management** for both purchases and sales
8. **Financial Ledger** for transaction tracking
9. **Payment Integration** with Razorpay
10. **Product Traceability** by batch/serial number
11. **Expiry Management** with alerts

The system follows a clean architecture with:

- **Backend**: NestJS with TypeORM (Repository pattern)
- **Frontend**: Angular 18+ with Standalone Components
- **Database**: MySQL with proper relationships and indexes

All batch and serial tracking validations are now complete and working correctly.
